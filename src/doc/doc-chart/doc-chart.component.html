<h1>Chart 图表</h1>

<p>图表是数据可视化的重要组件，帮助用户直观地理解和分析数据。</p>

<h2>何时使用</h2>
<p>当需要展示数据趋势、比较数据大小或表示数据分布时，图表是理想的选择。柱状图特别适合比较不同类别的数据值，饼图适合展示占比关系。</p>

<h2>柱状图示例</h2>

<div class="chart-docs-grid">
  <!-- 基本用法 -->
  <app-doc-box title="基本柱状图" [sourceCode]="basicChartCode">
    <div demo>
      <lib-button (click)="refreshData()">刷新数据</lib-button>
      <lib-bar [data]="basicData"></lib-bar>
    </div>
    <div description>
      <p>最基本的柱状图用法，展示一组数据的比较。</p>
      <p>只需提供 <code>data</code> 数组，每个数据项包含 <code>name</code> 和 <code>value</code>。</p>
    </div>
  </app-doc-box>

  <!-- 多柱状图 -->
  <app-doc-box title="多系列柱状图" [sourceCode]="multiSeriesChartCode">
    <div demo>
      <lib-bar [data]="multiSeriesData"></lib-bar>
    </div>
    <div description>
      <p>多系列柱状图可展示多组数据的对比，每个类别包含多个数据系列。</p>
      <p>点击图例可以切换显示/隐藏对应的数据系列。</p>
    </div>
  </app-doc-box>

  <!-- 多柱状图自定义 -->
  <app-doc-box title="自定义多系列柱状图" [sourceCode]="customMultiSeriesChartCode">
    <div demo>
      <lib-bar [data]="customMultiSeriesData" [options]="customMultiSeriesOptions"></lib-bar>
    </div>
    <div description>
      <p>可以为每个系列设置单独的名称和颜色，并自定义图例位置。</p>
      <p>即使所有系列都被隐藏，图表框架仍会保留，方便再次显示数据。</p>
    </div>
  </app-doc-box>

  <!-- 自定义颜色 -->
  <app-doc-box title="自定义颜色" [sourceCode]="colorChartCode">
    <div demo>
      <lib-bar [data]="basicData" [options]="colorOptions"></lib-bar>
    </div>
    <div description>
      <p>通过 <code>options</code> 属性中的 <code>barColors</code> 设置柱形颜色。</p>
      <p>自定义颜色可以增强数据的视觉区分度或符合品牌标识。</p>
    </div>
  </app-doc-box>

  <!-- 带标题的柱状图 -->
  <app-doc-box title="带标题的柱状图" [sourceCode]="titleChartCode">
    <div demo>
      <lib-bar [data]="salesData" [options]="titleOptions"></lib-bar>
    </div>
    <div description>
      <p>通过 <code>options</code> 属性中的 <code>title</code> 添加图表标题。</p>
      <p>标题可以帮助用户理解图表内容和上下文。</p>
    </div>
  </app-doc-box>

  <!-- 无网格线 -->
  <app-doc-box title="无网格线柱状图" [sourceCode]="noGridChartCode">
    <div demo>
      <lib-bar [data]="basicData" [options]="noGridOptions"></lib-bar>
    </div>
    <div description>
      <p>通过设置 <code>showGrid: false</code> 可以隐藏网格线，使图表更加简洁。</p>
      <p>在数据精确度不是关键时，无网格线的样式更加美观。</p>
    </div>
  </app-doc-box>

  <!-- 自定义圆角 -->
  <app-doc-box title="自定义圆角" [sourceCode]="radiusChartCode">
    <div demo>
      <lib-bar [data]="basicData" [options]="radiusOptions"></lib-bar>
    </div>
    <div description>
      <p>通过设置 <code>borderRadius</code> 可以调整柱形的圆角大小。</p>
      <p>更大的圆角可以创造现代、友好的视觉效果。</p>
    </div>
  </app-doc-box>

  <!-- 无动画效果 -->
  <app-doc-box title="无动画效果" [sourceCode]="noAnimateChartCode">
    <div demo>
      <lib-bar [data]="basicData" [options]="noAnimateOptions"></lib-bar>
    </div>
    <div description>
      <p>通过设置 <code>animate: false</code> 可以禁用图表的动画效果。</p>
      <p>在某些场景下，如数据频繁更新时，禁用动画可能更合适。</p>
    </div>
  </app-doc-box>

  <!-- 悬停效果 -->
  <app-doc-box title="悬停效果" [sourceCode]="hoverChartCode">
    <div demo>
      <lib-bar [data]="basicData" [options]="hoverOptions"></lib-bar>
    </div>
    <div description>
      <p>通过设置 <code>hoverEffect</code> 可以启用悬停效果，包括贯穿柱形的辅助线和悬浮框。</p>
      <p>将鼠标悬停在柱形上，可以看到垂直贯穿的虚线和显示数据的悬浮框。</p>
    </div>
  </app-doc-box>

  <!-- 零值测试 -->
  <app-doc-box title="零值处理测试" [sourceCode]="hoverChartCode">
    <div demo>
      <lib-bar [data]="zeroValueData" [options]="zeroValueOptions"></lib-bar>
    </div>
    <div description>
      <p>当数据值为0时，不会显示柱形，同时将数值标签显示在基线上方。</p>
      <p>这避免了因圆角设置导致在底部出现突出的半圆形问题。</p>
    </div>
  </app-doc-box>

  <!-- 点击事件 -->
  <app-doc-box title="点击事件" [sourceCode]="clickChartCode">
    <div demo>
      <lib-bar [data]="salesData" [options]="clickOptions"></lib-bar>
      <div *ngIf="clickedItem" class="click-result">
        <div class="click-result-title">点击结果：</div>
        <div class="click-result-content">
          <div>名称：{{ clickedItem.item.name }}</div>
          <div>数值：{{ clickedItem.item.data }}</div>
          <div>索引：{{ clickedItem.index }}</div>
          <div>图表标题：{{ clickedItem.options.title || '无标题' }}</div>
        </div>
      </div>
    </div>
    <div description>
      <p>通过设置 <code>onClick</code> 回调函数可以响应柱形的点击事件。</p>
      <p>回调函数会接收一个包含完整上下文信息的对象，包括点击的数据项、索引、完整数据集、图表配置和点击事件等。</p>
    </div>
  </app-doc-box>

  <!-- 自定义悬浮框 -->
  <app-doc-box title="自定义悬浮框" [sourceCode]="customTooltipCode">
    <div demo>
      <lib-bar [data]="salesData" [options]="customTooltipOptions" [tooltipTemplate]="customTooltip"></lib-bar>
      
      <ng-template #customTooltip let-item>
        <!-- 自定义悬浮框内容，右侧边框由组件设置 -->
        <div style="display: flex; width: 100%; flex-direction: column;">
          <div style="padding: 12px;">
            <div style="font-weight: 600; font-size: 16px; margin-bottom: 8px; color: #222; letter-spacing: -0.3px;">
              {{item.name}}
            </div>
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                <span style="color: #555; font-size: 13px; font-weight: 500;">销售额</span>
                <span style="font-weight: 500; color: #000; font-size: 13px; padding: 4px 10px;min-width: 60px; text-align: center;">{{formatSalesValue(item.item.data)}}</span>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                <span style="color: #555; font-size: 13px; font-weight: 500;">占比</span>
                <span style="font-weight: 500; color: #000; font-size: 13px; padding: 4px 10px; min-width: 60px; text-align: center;">{{((item.item.data / 840) * 100).toFixed(1)}}%</span>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #555; font-size: 13px; font-weight: 500;">详情</span>
                <span style="font-weight: 500; color: #3498db; font-size: 13px; padding: 4px 10px; min-width: 60px; text-align: center; cursor: pointer;">查看</span>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </div>
    <div description>
      <p>通过 <code>tooltipTemplate</code> 属性可以使用 Angular 模板自定义悬浮框的内容和样式。</p>
      <p>右侧彩色边框会自动使用对应柱形的颜色，保持视觉一致性。</p>
    </div>
  </app-doc-box>

  <!-- 多系列悬浮框 -->
  <app-doc-box title="多系列悬浮框" [sourceCode]="multiSeriesTooltipCode">
    <div demo>
      <lib-bar [data]="multiSeriesData" [options]="multiSeriesTooltipOptions" [tooltipTemplate]="multiSeriesTooltip"></lib-bar>
      
      <ng-template #multiSeriesTooltip let-data>
        <div style="display: flex; width: 100%; flex-direction: column;">
          <div style="padding: 12px;">
            <div style="font-weight: 600; font-size: 16px; margin-bottom: 8px; color: #222; letter-spacing: -0.3px;">
              {{data.series}} - {{data.item.name}}
            </div>
            <div style="display: flex; flex-direction: column;">
              <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                <span style="color: #555; font-size: 13px; font-weight: 500;">数值</span>
                <span style="font-weight: 500; color: #000; font-size: 13px; padding: 4px 10px;min-width: 60px; text-align: center;">{{formatValue(data.item.data)}}</span>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <span style="color: #555; font-size: 13px; font-weight: 500;">系列索引</span>
                <span style="font-weight: 500; color: #000; font-size: 13px; padding: 4px 10px; min-width: 60px; text-align: center;">{{data.seriesIndex}}</span>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </div>
    <div description>
      <p>多系列图表的悬浮框可以显示更丰富的信息，包括系列名称、数据点名称和值。</p>
      <p>通过模板可以自定义显示内容和样式，增强用户体验。</p>
    </div>
  </app-doc-box>
</div>

<!-- 饼图示例部分 -->
<h2>饼图示例</h2>

<div class="chart-docs-grid">
  <!-- 基本饼图 -->
  <app-doc-box title="基本饼图" [sourceCode]="basicPieChartCode">
    <div demo>
      <lib-pie [data]="pieData" [options]="basicPieOptions"></lib-pie>
    </div>
    <div description>
      <p>基本饼图用于展示不同类别数据的占比关系。</p>
      <p>通过配置 <code>showLabels</code> 和 <code>showPercentage</code> 可以在扇区上显示名称和百分比。</p>
    </div>
  </app-doc-box>

  <!-- 环形图 -->
  <app-doc-box title="环形图" [sourceCode]="donutPieChartCode">
    <div demo>
      <lib-pie [data]="donutPieData" [options]="donutPieOptions"></lib-pie>
    </div>
    <div description>
      <p>通过设置 <code>innerRadius</code> 可以创建环形图，适合在中心显示总计数据。</p>
      <p>环形图比传统饼图更现代化，同时可以在中心区域显示附加信息。</p>
    </div>
  </app-doc-box>

  <!-- 悬停效果饼图 -->
  <app-doc-box title="悬停效果" [sourceCode]="hoverPieChartCode">
    <div demo>
      <lib-pie [data]="pieData" [options]="hoverPieOptions"></lib-pie>
    </div>
    <div description>
      <p>通过设置 <code>hoverEffect</code> 可以启用悬停效果，包括悬浮框和扇区突出显示。</p>
      <p>当鼠标悬停在扇区上时，扇区会向外突出并显示详细信息。</p>
    </div>
  </app-doc-box>

  <!-- 饼图点击事件 -->
  <app-doc-box title="点击事件" [sourceCode]="pieClickChartCode">
    <div demo>
      <lib-pie [data]="pieData" [options]="pieClickOptions"></lib-pie>
      <div *ngIf="clickedPieItem" class="click-result">
        <div class="click-result-title">点击结果：</div>
        <div class="click-result-content">
          <div>名称：{{ clickedPieItem.item.name }}</div>
          <div>数值：{{ clickedPieItem.item.value }}</div>
          <div>百分比：{{ clickedPieItem.item.percentage.toFixed(1) }}%</div>
          <div>索引：{{ clickedPieItem.index }}</div>
        </div>
      </div>
    </div>
    <div description>
      <p>通过设置 <code>onClick</code> 回调函数可以响应扇区的点击事件。</p>
      <p>回调函数会接收包含完整上下文信息的对象，包括点击的扇区数据、索引和百分比等。</p>
    </div>
  </app-doc-box>

  <!-- 图表类型切换 -->
  <app-doc-box title="图表类型切换" [sourceCode]="toggleChartTypeCode">
    <div demo>
      <div style="margin-bottom: 16px;">
        <lib-button (click)="toggleChartType()">
          切换到{{ isBarChart ? '饼图' : '柱状图' }}
        </lib-button>
      </div>
      
      <ng-container *ngIf="isBarChart; else pieChartTemplate">
        <lib-bar [data]="toggleChartData" [options]="barChartOptions"></lib-bar>
      </ng-container>
      
      <ng-template #pieChartTemplate>
        <lib-pie 
          [data]="togglePieData" 
          [options]="pieChartOptions">
        </lib-pie>
      </ng-template>
    </div>
    <div description>
      <p>可以根据需要在柱状图和饼图之间切换，以不同方式可视化相同的数据。</p>
      <p>饼图和柱状图在切换时保持颜色一致性，提供更好的用户体验。</p>
      <p>使用<code>ChartService</code>中的转换方法可以简化图表类型间的转换过程。</p>
    </div>
  </app-doc-box>
</div>

<h2>API</h2>
<app-doc-api-table [apiData]="apiSections"></app-doc-api-table>
